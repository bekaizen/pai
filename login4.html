<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title id="cont">PAI</title>
<link rel="shortcut icon" href="icon/pai.png"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/w3.css">
<meta name="theme-color" content="#ffffff">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="icon" type="image/png" href="icon/pai.png" >
<meta name="application-name" content="PAI">
<link rel="stylesheet" href="font-awesome/6.1.1/css/all.css">
<script src="js/jquery-3.6.0.min.js"></script>
<script src="cordova.js"></script>
<script type="text/javascript" charset="utf-8">
        $(document).ready(function () {
             document.addEventListener("deviceready", onDeviceReady, false); 


        });
        AppenUso=false;
        function onDeviceReady() {

            StatusBar.overlaysWebView(false);
            StatusBar.backgroundColorByHexString("#ffffff"); 
            StatusBar.styleDefault();
            //StatusBar.styleLightContent();
            AppenUso=true;

        }
</script>
<style>
html,body,h1,h2,h3,h4,h5 {font-family: "RobotoDraft", "Roboto", sans-serif;}
.blue-dark{background-color:#1565c0}
.blue-menu{color:#1565c0}

.noselect {
     
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
            
}

textarea,input:not([type="radio"]):not([type="checkbox"]) {
    -webkit-appearance: none;
    border-radius: 0;
}
</style>
</head>
<body class="w3-white noselect w3-col l5" style="padding-top: constant(safe-area-inset-top);padding-top: env(safe-area-inset-top);">




<!-- Page content -->
<div id="notifigener" class="w3-animate-top w3-col m12 s12 l12 w3-container w3-center" style="position:fixed;display:none;z-index:2"></div>


 <div class="w3-container w3-white">

<form class="w3-margin-top w3-margin-bottom w3-container">   
  <h1 class="w3-text-black w3-center"><b>Bienvenido a</b></h1>
  <center><img src="icon/pai.png" class="w3-circle w3-light-grey" width="70px">
    <small class="w3-col s12 m12 l12"><b>PAI E</b>xchange</small>
  </center><br><br>
<div id="loginarea">  
  <div class="w3-margin-bottom  w3-margin-top">
    <i class="fa-regular fa-user w3-col s2 m2 l2 w3-xlarge w3-text-cyan w3-padding-top"></i>
    <input class="w3-input w3-col s10 l10 m10 w3-border-bottom w3-large w3-margin-bottom w3-white" type="text" id='user_name' placeholder="Email o usuario" style="outline:none">
  </div>

  
  <div class="w3-margin-bottom  w3-margin-top">
    <i class="fa-solid fa-lock w3-col s2 m2 l2 w3-xlarge w3-text-cyan w3-padding-top" id="lock" data="lock" onclick="toggleInput($('#lock').attr('data'))"></i>
    <input class="w3-input w3-border-bottom w3-col s10 m10 l10 w3-large w3-white" type="password" id='psw' placeholder="Contraseña" style="outline:none">
  </div>
  
          
  <div class="w3-margin-bottom w3-margin-top">  
   <!-- <input type="checkbox" class="w3-margin-top" value="yes"><label class="w3-text-black"> Sesión activa</label>-->
    <button class="w3-btn w3-blue w3-col s12  w3-large w3-round-xxlarge w3-margin-top" onclick="enter($('#user_name').val(),$('#psw').val());return false"> Acceder </button>
  </div>
</div>   



<!-- 2FA verification -->          
   <div class="w3-margin-bottom  w3-margin-top" id="2farea" style="display:none">
     
    <input class="w3-input w3-border-bottom w3-large w3-col s12" type="number" id='2fa' placeholder="Código 2fa" oninput="if(value.length==6){ Twofactor(value); }" style="outline:none">
  </div>
<!-- // 2FA verification -->   


<!-- Email 2fa verification -->          
   <div class="w3-margin-bottom  w3-margin-top" id="Email2fa" style="display:none">
     
    <input class="w3-input w3-border-bottom w3-large w3-col s12" type="number" id='mail2fa' placeholder="Código email" oninput="if(value.length==6){ Twofactor(value); }" style="outline:none">
  </div>
<!-- //Email 2FA verification -->  
</form>
  
 
  <div class="w3-center w3-padding-64">
     
    <div class="w3-col s12 m12 l12 w3-margin-bottom" >¿No tiene una cuenta? <a href="signup.html" style="text-decoration:none"><b>Regístrese</b></a>.</div>
    <a href="recuperar.html" style="text-decoration:none"><b>¿Olvidó su contraseña?</b></a> 
</div>
 
 <div class="w3-margin-bottom w3-text-blue-grey w3-container w3-center">         
     <p> ® PAI Exchange.</p>
  </div>
 
</div>
<footer class="w3-botttom w3-container w3-center  w3-margin-bottom">
     <i onclick="abrirEnlaceExterno('https://fb.com/paiexchange')" class="fab fa-facebook  fa-2x w3-text-blue   w3-col s2 m2 l2"></i>
     <i onclick="abrirEnlaceExterno('https://instagram.com/paiexchange')" class="fab fa-instagram fa-2x w3-text-pink   w3-col s2 m2 l2"></i>
     <i onclick="abrirEnlaceExterno('https://t.me/paiexchange')" class="fab fa-telegram  fa-2x w3-text-cyan   w3-col s2 m2 l2"></i>
     <i onclick="abrirEnlaceExterno('https://youtube.com/c/paiexchange')" class="fab fa-youtube   fa-2x w3-text-red    w3-col s2 m2 l2"></i>
     <i onclick="abrirEnlaceExterno('https://twitter.com/paiexchange')" class="fab fa-twitter   fa-2x w3-text-blue   w3-col s2 m2 l2"></i>
     <i onclick="abrirEnlaceExterno('mailto:soporte@paiexchange.com')" class="fas fa-envelope  fa-2x w3-text-yellow w3-col s2 m2 l2"></i>
</footer>

      

 
<!-- // Page content END--> 


<!-- Loader -->
<div id="loadergif" class="w3-modal">
  <div class="w3-display-middle">
  <center>
      <img src="icon/loader.gif" class="w3-round" width="70">
  </center>    
  </div>
</div>
<!-- // Loader// -->
<script>
if(/(http)/i.test(window.location.protocol))
{
    UrlAPI=window.location.hostname;
}
else
{
    UrlAPI='api.paiexchange.com';
}
</script>
<script>
function abrirEnlaceExterno(enlace)
{
 if(AppenUso==true)
 {
    cordova.InAppBrowser.open(enlace, '_system');
 }
 else
 {
     window.open(enlace, '_system')
 }
}    
</script>
<script>
function toggleInput(value)
{
  if(value=='lock')
  { 
     $('#psw').attr('type','text');
     $('#lock').removeClass('fa-solid fa-lock').addClass('fa-solid fa-lock-open');
     $('#lock').attr('data','unlock');
  }
  else
  {
    $('#psw').attr('type','password');
    $('#lock').removeClass('fa-solid fa-lock-open').addClass('fa-solid fa-lock');
    $('#lock').attr('data','lock');
  }
}  
</script> 

<script>
function enter(user,psw){
if(user=='')
{ 
   $("#user_name").focus();
}
else if(psw=='')
{
   $("#psw").focus();
}
else
{

var parametros = {
"user" : user,
"psw" : psw, 

};
$.ajax({
data: parametros,
url: 'https://'+UrlAPI+'/app_login',
type: 'post',
beforeSend: function () 
{
 $('#loadergif').show();
},
success: function (response)
{

  $("#loadergif").hide();
  if(response=='')
  { 
     $("#notifigener").removeClass('w3-green').addClass('w3-red');
     $("#notifigener").html("<p> Hay un problema con el servidor</p>");
     $("#notifigener").show();
     setTimeout(function(){ $("#notifigener").hide(); }, 6000);
  }
  else if(response=='ok2')
  {

    $('#loginarea').hide();
    $('#2farea').show();
    $('#2fa').focus();
    
  }
  else if(response=='ok')
  {
    
      localStorage.setItem("Sesion", "true");
      window.location.href="panel.html";
    
  }
  else
  {
     $("#notifigener").removeClass('w3-green').addClass('w3-red');
     $("#notifigener").html("<p>"+response+"</p>");
     $("#notifigener").show();
     setTimeout(function(){ $("#notifigener").hide(); }, 6000);
  }
  
},

error: function (response)
{
     $("#notifigener").removeClass('w3-green').addClass('w3-red');
     $("#notifigener").html("<p> Favor verifique su conexión a internet</p>");
     $("#notifigener").show();
     setTimeout(function(){ $("#notifigener").hide(); }, 6000);
     $("#loadergif").hide();
}

});
 }
}
</script>


<script>
function Twofactor(code)
{
  
var parametros = {
"code" : code,
};
$.ajax({
data: parametros,
url: 'https://'+UrlAPI+'/2fa_sesion',
type: 'post',
beforeSend: function () 
{
 $('#loadergif').show();
},
success: function (response)
{

  $("#loadergif").hide();
  if(response=='')
  { 
     $("#notifigener").removeClass('w3-green').addClass('w3-red');
     $("#notifigener").html("<p> Hay un problema con el servidor</p>");
     $("#notifigener").show();
     setTimeout(function(){ $("#notifigener").hide(); }, 6000);
  }
  else if(response=='ok')
  {
    localStorage.setItem("Sesion", "true");
    window.location.href="panel.html";
    
  } else
  {
     $("#notifigener").removeClass('w3-green').addClass('w3-red');
     $("#notifigener").html("<p>Error código incorrecto</p>");
     $("#notifigener").show();
     $('#2fa').val('');
     setTimeout(function(){ $("#notifigener").hide(); }, 6000);
  }
  
},

error: function (response)
{
     $("#notifigener").removeClass('w3-green').addClass('w3-red');
     $("#notifigener").html("<p> Favor verifique su conexión a internet</p>");
     $("#notifigener").show();
     setTimeout(function(){ $("#notifigener").hide(); }, 6000);
     $("#loadergif").hide();
}

});  
}
</script>
<script>
function NotifiAlert(mensaje,color,tiempo)
{
     if(color=='w3-green'){ remov='w3-red'; } else { remov='w3-green'; }
     
     $("#notifigener").removeClass(remov).addClass(color);
     $("#notifigener").html("<p>"+mensaje+"</p>");
     $("#notifigener").show();
     setTimeout(function(){ $("#notifigener").hide(); }, tiempo);
}     
</script>
</body>
</html>