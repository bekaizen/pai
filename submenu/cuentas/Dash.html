<div class="w3-top w3-col l5">

<div class="w3-container w3-white w3-center">
<i class="fa-solid fa-clock-rotate-left w3-right w3-padding-left w3-padding-top w3-large w3-text-grey" style="cursor:pointer" onclick="OpenAcount('Historial')"></i>

<div class="w3-margin-top w3-margin-bottom w3-col s12 w3-border w3-round w3-large w3-padding noselect">
    <span class="w3-center"><img src="icon/DASH.png" width="32px"> DASH</span> 
    <select class="w3-select w3-white w3-right w3-col s4 m4 l4 w3-border-0" style="outline:none" onchange="cambiarProtocolo(value)" id="protocolos"></select>
</div> 


<div id="qrbch" style="min-height:150px">&nbsp;</div>
<div class="w3-margin-top w3-round w3-large w3-light-grey w3-round reajuste w3-col s12 m12 l12 pointer" onclick="copiarTexto('addrcript','si')">
  <span style="user-select: all" class="w3-col s11 m11 l11 w3-padding-top w3-padding-bottom" id='addrcript'></span> 
  <i class="fa-solid fa-copy w3-text-grey w3-col s1 m1 l1 w3-padding-top w3-padding-bottom"></i>
</div>

</div>

<div class="w3-col s12 w3-white w3-margin-bottom w3-container noselect">
    

<div class="w3-leftbar w3-margin-bottom w3-margin-top"><span class="w3-margin-left">Calcula cuánto recibes</span></div>
<div class="w3-col s4">
         <input class="w3-input w3-border" type="number" id="amoutmond" placeholder="DASH" oninput="Cacularmoned(value)">
         <small class="w3-col s12" id='mndprec'></small>
</div>

<div class="w3-col s2 w3-center">
         <i class="fa fa-exchange-alt w3-text-blue-grey fa-2x w3-padding-top"></i>
</div>

<div class="w3-col s6 w3-center w3-margin-bottom">
         <div class="w3-col s12 w3-bottombar"> <span id="usdresult">0.00</span> USD </div>
         <span class="w3-col s12 w3-center">Comisión incluida</span>
</div>
</div>




</div>

 <!-- Confirmacion-->
<div id="adddirect" class="w3-modal noselect">
  <div class="w3-display-middle  w3-white w3-round w3-round-xlarge w3-animate-fade w3-card-2 w3-col l10 m10 s10">
      
      <p class="w3-padding-32 w3-center reajuste w3-container">¿Desea generar una nueva dirección de <span id="monednomdr"></span>?</p>
      
      <div class="w3-col s6 m6 l6 w3-large w3-padding-16 w3-center w3-border-right w3-border-top w3-border-lightgrey" style="cursor:pointer" onclick="$('#adddirect').hide();">No</div>
      <div class="w3-col s6 m6 l6 w3-large w3-padding-16 w3-center  w3-border-top w3-text-blue w3-border-lightgrey" style="cursor:pointer" id="addaddrConfirm" onclick="">Si</div>
  </div>
</div>
<!-- //Confirmacion// -->
 <!-- info-->
<div id="infoarea" class="w3-modal noselect w3-col l5" style="display:none">
  <div class="w3-display-middle  w3-white w3-round w3-round-xlarge w3-animate-fade w3-card-2 w3-col l10 m10 s10">
      <div class="w3-padding-16  reajuste w3-container" align="">
          <center>
                <b>Antes de realizar cualquier transacción tome en cuenta lo siguiente:</b>
          </center>
          <br>-  Esta dirección de billetera <b>solo</b> acepta transacciones de BNB (BSC) y Tokens BEP20, <b>no envíe </b>ningún token ERC20 o Ethereum.
          Cualquier otro token o moneda no sera reflejado. 
          <p> -  Las transacciones de <b>contratos</b> no son reflejadas, 
          asegúrese de  investigar con su proveedor o billetera la forma en que se efectuan las transacciones, para evitar demoras innecesarias.</p>
              
              <input type="checkbox" id="checkarea" onclick="habilitaraceptar()"> Confirmo que estoy de acuerdo con estos términos.
      
      </div>
      
      <div id="infoacept" class="w3-col s12 m12 l12 w3-large w3-padding-16 w3-center  w3-border-top w3-border-lightgrey w3-text-blue" style="cursor:pointer" onclick="$('#checkarea').focus()">Aceptar</div>
  </div>
</div>
<!-- //info// -->
<script>
protocolos=''; //bep20 trc20 erc20
function cambiarProtocolo(value){
           
    
          for(i=0;i<protocolos.length;i++)
          { 
             if(protocolos[i].id==value)
             {
                 $('#qrbch').html(''); 
                 $('#qrbch').qrcode({render: 'image',size: 150,text: protocolos[i].cartera,mode: 0, ecLevel: 'M'}); 
                 $("#addrcript").html(protocolos[i].direcionSegura); 
             }
          }
}    
</script>
<script>
function habilitaraceptar()
{  if(localStorage.getItem('infobusd')==null){
    localStorage.setItem('infobusd',0);
   }
    var accions="$('#infoarea').hide()";
    localStorage.setItem('infobusd', parseFloat(localStorage.getItem('infobusd'))+parseFloat(1));
    $('#infoacept').attr('onclick',accions);
}
if(parseFloat(localStorage.getItem('infobusd'))>parseFloat(3))
{
 $('#infoarea').hide();
}

//MenuAccion('fas fa-redo-alt',"GenerAdrrConfir('Binance Coin')");  
EstatusBarColor('ffffff');
$('#menusup').hide();


//Variables Glabales
var simbolo='DASH';
var moneda='DASH';
var decimales=2;


function formatNumber(num) {
    num=parseFloat(num).toFixed(2);
    return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,");
}
function historialcripto(pagina)
{
var datos= {
'tipo':moneda,
'codigo':simbolo
}

$.ajax({
data: datos,
url: 'https://'+UrlAPI+'/AppHistorialDepositos',
type: 'post',
beforeSend: function ()
{
   //$('#loadergif').show();
},
success: function (response)
{
  $('#loadergif').hide(); 
  if(response=='')
  { 

     NotifiAlert("Problemas de comunicación con el servidor",'w3-red',5000);
  }
  else 
  {
  
     var objt=JSON.parse(response);
     if(objt.session=='true')
     {
          $("#addrcript").html(objt.wallets[0].direcionSegura);   
          $('#qrbch').qrcode({render: 'image',size: 150,text: objt.wallets[0].cartera,mode: 0, ecLevel: 'M'});
           
          $("#mndprec").html('1 '+simbolo+' = '+formatonumero(JsonPrecios[simbolo],decimales)+' USD'); 
          fee=parseFloat(1-objt.fee);
          
          protocolos=objt.wallets;
          for(i=0;i<objt.wallets.length;i++)
          { 
             $('#protocolos').append('<option value="'+objt.wallets[i].id+'">'+objt.wallets[i].protocolo+'</option>');
          }
      }
      else
      {
        CerrarSesion();
      }
    
	    
  }
},
error: function (response)
{
   NotifiAlert("Problemas de comunicación con el servidor o verifique su internet",'w3-red',6000);
   $('#loadergif').hide();
}

});
}
historialcripto(1);
</script>

<script>                       
function Cacularmoned(valor)
{
    
  if(valor.indexOf(".")>-1)
  {
    var valor= valor.split('.'); var valor=valor[0]+'.'+valor[1].slice(0,8);
    $('#amoutmond').val(valor);
  }
  
  $("#usdresult").html(formatNumber(parseFloat((JsonPrecios[simbolo]*valor)*fee),2));   
}
</script>
<script>
function Generardireccion(tipo)
{

var parametros={
"tipo":tipo
}

$.ajax({
data:parametros,
url: 'https://'+UrlAPI+'/AppAddAddr',
type: 'post',
beforeSend: function ()
{
   $('#loadergif').show();
},
success: function (response)
{
  $('#loadergif').hide(); 
  if(response=='')
  { 
  
     NotifiAlert("No se ha obtenido resultados, compruebe su conexión",'w3-red',6000);
  }
  else 
  {
  
    var objt=JSON.parse(response);
    if(objt.session=='true')
    {
    
     $("#notifigener").removeClass('w3-green').removeClass('w3-red').addClass(objt.estado);
     $("#notifigener").html("<p>"+objt.mensaje+"</p>");
     $("#notifigener").show();
     setTimeout(function(){ $("#notifigener").hide(); }, 4000);
     
     if(objt.estado=='w3-green')
     {
          $("#addrcript").html(objt.DireccionSegura);   
          $('#qrbch').html('');
          //$('#qrbch').qrcode({render: 'image',size: 180,text: objt.Direccion,mode: 2, ecLevel: 'M',label:objt.Direccion.substring(0, 3)+'...'+objt.Direccion.substring(objt.Direccion.length-3, objt.Direccion.length),fontcolor: 'grey'});
           $('#qrbch').qrcode({render: 'image',size: 150,text: objt.Direccion,mode: 0, ecLevel: 'M'}); 
     }
      
    }
    else
    {
      document.cookie = "app=";
      OpenOption('login');
    }
    
       
	    
  }
  
  
},

error: function (response)
{
   NotifiAlert("Verifique su conexión a internet",'w3-red',6000);
   $('#loadergif').hide();
}

});
}
</script>
<script>
function GenerAdrrConfir(moneda)
{
    $('#addaddrConfirm').attr('onclick',"Generardireccion('"+moneda+"');$('#adddirect').hide()");
    $('#monednomdr').html(moneda);
    $('#adddirect').show();
}
</script>