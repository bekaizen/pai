<div class="w3-container w3-white noselect">
    
    <div class="w3-white w3-col s12 m12 l12">
     <div class="w3-col s2 m2 l2 w3-margin-top"><i class="fas fa-globe w3-large w3-text-green"></i></div>
      <select class="w3-select w3-border-bottom w3-col l10 m10 s10 w3-white w3-margin-bottom w3-margin-top" id="paises" onchange="DesplegarServicios(value);" style="outline:none">
        <option value=''  selected>Seleccione el pais</option>
      </select>
    </div>
    <div class="w3-col s2 m2 l2 w3-margin-top"><i class="fa-solid fa-list-check w3-large w3-text-grey"></i></div> 
     <select class="w3-select w3-border-bottom w3-col l10 m10 s10 w3-white  w3-margin-bottom w3-margin-top" id="servicios" onchange="DesplegarOpciones(value);" style="outline:none">
        <option value=''  selected>Seleccione tipo de servicio</option>
     </select>
     
    <div class="w3-col s2 m2 l2 w3-margin-top"><i class="fa-brands fa-elementor w3-large w3-text-grey"></i></div> 
     <select class="w3-select w3-border-bottom w3-col l10 m10 s10 w3-white  w3-margin-bottom w3-margin-top" id="opciones"  onchange="DesplegarOtraOpciones();" style="outline:none">
        <option value=''  selected>Seleccione la opción</option>
     </select>
     
    <!-- area paqueticos--> 
    <div id="areapaqueticos" class="w3-hide">
     <div class="w3-col s2 m2 l2 w3-margin-top"><i class="fa-solid fa-circle-dollar-to-slot w3-large w3-text-grey"></i></div> 
     <select class="w3-select w3-border-bottom w3-col l10 m10 s10 w3-white  w3-margin-bottom w3-margin-top" id="paqueticos"  style="outline:none">
        <option value=''  selected>Seleccione el paquete</option>
     </select>
      <i class="fa-solid fa-mobile-screen w3-col s2 m2 l2  w3-large w3-text-grey w3-margin-top"></i>
      <input type="number" placeholder='Intruduzca el número' class="w3-input w3-border-bottom w3-col l10 m10 s10 w3-white  w3-margin-bottom w3-margin-top" id="numeroPaquete"  style="outline:none">
      <botton id="" class="w3-btn w3-blue w3-margin-top w3-margin-bottom w3-round w3-round-large w3-col s12 m12 l12" onclick="EnviarPaquetico($('#paqueticos').val(),$('#numeroPaquete').val(),$('#opciones').val())">Comprar paquetico</botton>
    </div>  
    
    <!-- area para recarga-->
    <div id="areamonto" class="w3-hide">
     <div class="w3-col s2 m2 l2 w3-margin-top"><i class="fa-solid fa-mobile-retro w3-large w3-text-grey"></i></div> 
     <input type="number" placeholder='Intruduzca el número' class="w3-input w3-border-bottom w3-col l10 m10 s10 w3-white  w3-margin-bottom w3-margin-top" id="numeroRecarga"  style="outline:none">
     <i class="fa-solid fa-money-bills w3-col s2 m2 l2  w3-large w3-text-grey w3-margin-top"></i>
     <input type="number" placeholder='Intruduzca el monto DOP' class="w3-input w3-border-bottom w3-col l10 m10 s10 w3-white  w3-margin-bottom w3-margin-top" id="montoRecarga"  style="outline:none">
     <botton id="" class="w3-btn w3-blue w3-margin-top w3-margin-bottom w3-round w3-round-large w3-col s12 m12 l12" onclick="EnviarRecargas($('#opciones').val(),$('#numeroRecarga').val(),$('#montoRecarga').val())">Enviar recarga</botton>
    </div>
    
    <!-- area para facturas-->
    <div id="areafacturas" class="w3-hide">
     <div class="w3-col s2 m2 l2 w3-margin-top"><i class="fa-regular fa-newspaper w3-large w3-text-grey"></i></div> 
     <input oninput='$("#btnConsultaFactura").show();$("#detalleFactura").hide()' placeholder='Número de factura' class="w3-input w3-border-bottom w3-col l10 m10 s10 w3-white w3-margin-bottom w3-margin-top" id="factura"  style="outline:none">
     <botton id="btnConsultaFactura" class="w3-btn w3-blue w3-margin-top w3-margin-bottom w3-round w3-round-large w3-col s12 m12 l12" onclick="ConsultFactura($('#opciones').val(),$('#factura').val())">Consultar</botton>
     <div id="detalleFactura" style="display:none"> 
      <div style="display:block"  class="w3-container w3-round w3-round-large w3-border w3-border-light-grey w3-col s12 m12 l12">
         <p id="factTitular"></p>
         <p id="factfecha"></p>
         <p id="factPago"></p>
      </div>
      <i class="fa-solid fa-cash-register w3-col s2 m2 l2  w3-large w3-text-grey w3-margin-top"></i>
      <input type="number" placeholder='Monto a pagar en DOP' class="w3-input w3-border-bottom w3-col l10 m10 s10 w3-white w3-margin-bottom w3-margin-top" id="montoFactura"  style="outline:none">
      <botton id="ftbtn" class="w3-btn w3-blue w3-margin-top w3-margin-bottom w3-round w3-round-large w3-col s12 m12 l12" onclick="PagarFactura($('#opciones').val(),$('#factura').val(),$('#montoFactura').val())">Pagar factura</botton>
     </div>
    </div>
    

 
</div>

<!-- Confirmacion-->
<div id="recconfirm" class="w3-modal noselect">
  <div class="w3-display-middle  w3-white w3-round w3-round-xlarge w3-animate-fade w3-card-2 w3-col l10 m10 s10">
      
      <div class="w3-padding-16 w3-center reajuste w3-container">
            <p class="w3-large">Por favor confirme los datos.</p>
            <p class="w3-large"><b id="operconfirm"></b></p>
            <p class="w3-large"><span id="numconfirm"></span></p>
            <p class="w3-large"><span id="montconfirm"></span> DOP</p>
      </div>
      
      <div class="w3-col s6 m6 l6 w3-large w3-padding-16 w3-center w3-border-right w3-border-top w3-border-lightgrey" style="cursor:pointer" onclick="$('#recconfirm').hide();">Cancelar</div>
      <div class="w3-col s6 m6 l6 w3-large w3-padding-16 w3-center w3-border-top w3-text-blue w3-border-lightgrey" style="cursor:pointer"  onclick="PagarServicio($('#operadora').val(),$('#NumeroCel').val(),$('#cantidad').val(),'recargas');$('#recconfirm').hide()">Enviar</div>
  </div>
</div>
<!-- //Confirmacion// -->


<script>
Datosservicios='';

$.ajax({
url: 'https://'+UrlAPI+'/AppListadoServicios',
type: 'post',
beforeSend: function ()
{
   //$('#loadergif').show();
},
success: function (response)
{
  $('#loadergif').hide(); 
  if(response=='')
  { 
     NotifiAlert('Error de comunicación','w3-red',6000);
  }
  else 
  {
  
    var objt=JSON.parse(response);
    Datosservicios=objt;
    if(objt.session=='true')
    {

        //paises
        $.each(objt.datos, function(key,value) {
         $('#paises').append('<option value="'+key+'">'+Datosservicios.paises[key]['pais']+'</option>');
        });
      
    }
    else
    {
        CerrarSesion();
    }
    
       
	    
  }
  
  
},

error: function (response)
{
   NotifiAlert('No se ha obtenido resultados, compruebe su conexión','w3-red',6000);
   $('#loadergif').hide();
}

});

</script>


<script>
function DesplegarServicios(pais){
    $('#servicios').children('option:not(:first)').remove();
    $('#opciones').children('option:not(:first)').remove();
    $.each(Datosservicios.datos[pais], function(key,value) {
        $('#servicios').append('<option value="'+key+'">'+key+'</option>');
    });
}    
</script>
<script>
function DesplegarOpciones(servicio){
    $('#opciones').children('option:not(:first)').remove();
    $('#areapaqueticos,#areamonto,#areafacturas').attr('class','w3-hide');
    var pais=$('#paises').val();
    $.each(Datosservicios.datos[pais][servicio], function(key,value)
    {   if(servicio=='Paqueticos')
        {
            $('#opciones').append('<option value="'+key+'">'+key+'</option>');
        }
        else
        {
          $('#opciones').append('<option value="'+value.nombreClave+'">'+value.nombre+'</option>');
        }
    });
}    
</script>

<script>
function DesplegarOtraOpciones(){ 
    var pais=$('#paises').val();
    var servicio=$('#servicios').val();
    var opcion=$('#opciones').val();
    if(servicio=='Paqueticos')
    { 
       $.each(Datosservicios.datos[pais][servicio][opcion], function(key,value)
       {
          $('#areapaqueticos').attr('class',''); //mostrar area de paqueticos
          $('#paqueticos').append('<option value="'+value.id+'">'+value.nombre+' '+value.precio+'</option>');
       });
    }
    else if(servicio=='Recargas')
    {  
       //moneda fiat
       $('#montoRecarga').attr('placeholder','Monto en '+Datosservicios.paises[pais]['moneda']);
       $('#areamonto').attr('class',''); //mostrar esa area
    }
    else
    {  
       $('#areafacturas').attr('class',''); //mostrar  area facturas
    }
}    
</script>


<script>
function ConsultFactura(proveedor,cuenta)
{
    
if(proveedor=='' || cuenta=='')
{
    NotifiAlert('Por favor complete todos los campos','w3-red',6000);
}
else
{
    
var datos= {
'proveedor':proveedor,
'cuenta':cuenta
}

$.ajax({
data: datos,
url: 'https://'+UrlAPI+'/AppConsultaFactura',
type: 'post',
beforeSend: function ()
{
   $('#loadergif').show();
},
success: function (response)
{
  $('#loadergif').hide(); 
  if(response=='')
  { 
     NotifiAlert('No se ha obtenido resultados, compruebe su conexión','w3-red',6000);
  }
  else 
  {
  
     var objt=JSON.parse(response);
     if(objt.session=='true')
     {
  
       
          //transacciones
          if(objt.estado=='ok')
          {   
               
                
               //mostrar los botones de pagar facturas y ocultar consultar
               $("#detalleFactura").show(); 
               $("#btnConsultaFactura").hide();  
              
               $("#factPago").html(formatonumero(objt.datos.total_to_pay,2)+' DOP');   
               $("#factTitular").html(objt.datos.customer.first_name+' '+objt.datos.customer.last_name);  
               $("#factfecha").html(objt.datos.invoices[0].date_exp);  
               if(objt.datos.total_to_pay==0)
               {
                  $("#ftbtn").attr('disabled','disabled');
               }
               else
               {
                  $("#ftbtn").removeAttr('disabled');
               }
          }
          else
          {
               NotifiAlert(objt.msj,'w3-red',6000);
          }
          
      }
      else
      {
         CerrarSesion();
      }
    
       
	    
  }
  
  
},

error: function (response)
{
   NotifiAlert('Verifique su conexión a internet','w3-red',6000);
   $('#loadergif').hide();
}

});
}
}
</script>        
<script>
function PagarFactura(proveedor,cuenta,cantidad)
{
    

if(proveedor=='' || cuenta==''  || cantidad=='')
{
    NotifiAlert('Por favor complete todos los campos.','w3-red',6000);
}
else
{

var datos= {
'proveedor':proveedor,
'cuenta':cuenta,
'cantidad':cantidad
}

$.ajax({
data: datos,
url: 'https://'+UrlAPI+'/AppPagarFactura',
type: 'post',
beforeSend: function ()
{
   $('#loadergif').show();
},
success: function (response)
{
  $('#loadergif').hide(); 
  if(response=='')
  { 
     NotifiAlert('No se ha obtenido resultados, compruebe su conexión','w3-red',6000);
  }
  else 
  {
  
     var objt=JSON.parse(response);
     if(objt.session=='true')
     {
  
       
         //transacciones
         if(objt.estado=='ok')
         {   
     
             NotifiAlert(objt.msj,'w3-green',6000);
             AreaServicios('historial');
            
          }
          else
          {
               NotifiAlert(objt.msj,'w3-red',6000);
          }
          
     }
     else
     {
         CerrarSesion();
     }
    
       
	    
  }
  
  
},

error: function (response)
{
   NotifiAlert('Verifique su conexión a internet','w3-red',6000);
   $('#loadergif').hide();
}

});
}
}
</script>
<script>
function EnviarRecargas(proveedor,numero,cantidad)
{
    
if(proveedor=='' || numero==''  || cantidad=='')
{
    NotifiAlert('Por favor complete todos los campos.','w3-red',6000);
}
else
{
var pais=$('#paises').val();
var monedaFiat=Datosservicios.paises[pais]['moneda'];

var datos= {
'proveedor':proveedor,
'numero':numero,
'cantidad':cantidad,
'pais':pais,
'moneda':monedaFiat

}

$.ajax({
data: datos,
url: 'https://'+UrlAPI+'/AppEnviarRecargas',
type: 'post',
beforeSend: function ()
{
   $('#loadergif').show();
},
success: function (response)
{
  $('#loadergif').hide(); 
  if(response=='')
  { 
     NotifiAlert('No se ha obtenido resultados, compruebe su conexión','w3-red',6000);
  }
  else 
  {
  
     var objt=JSON.parse(response);
     if(objt.session=='true')
     {
  
       
         //transacciones
         if(objt.estado=='ok')
         {   
     
             NotifiAlert(objt.msj,'w3-green',6000);
             AreaServicios('historial');
            
          }
          else
          {
               NotifiAlert(objt.msj,'w3-red',6000);
          }
          
     }
     else
     {
         CerrarSesion();
     }
    
       
	    
  }
  
  
},

error: function (response)
{
   NotifiAlert('Verifique su conexión a internet','w3-red',6000);
   $('#loadergif').hide();
}

});
}
}
</script>
<script>
function EnviarPaquetico(IDpaquete,numero,proveedor)
{
    
if(IDpaquete=='' || numero=='' || proveedor=='')
{
    NotifiAlert('Por favor complete todos los campos.','w3-red',6000);
}
else
{
var pais=$('#paises').val();
var monedaFiat=Datosservicios.paises[pais]['moneda'];

var datos= {
'IDpaquete':IDpaquete,
'numero':numero,
'proveedor':proveedor,
'pais':pais,
'moneda':monedaFiat
}

$.ajax({
data: datos,
url: 'https://'+UrlAPI+'/AppEnviarPaquetico',
type: 'post',
beforeSend: function ()
{
   $('#loadergif').show();
},
success: function (response)
{
  $('#loadergif').hide(); 
  if(response=='')
  { 
     NotifiAlert('No se ha obtenido resultados, compruebe su conexión','w3-red',6000);
  }
  else 
  {
  
     var objt=JSON.parse(response);
     if(objt.session=='true')
     {
  
       
         //transacciones
         if(objt.estado=='ok')
         {   
     
             NotifiAlert(objt.msj,'w3-green',6000);
             AreaServicios('historial');
            
          }
          else
          {
               NotifiAlert(objt.msj,'w3-red',6000);
          }
          
     }
     else
     {
         CerrarSesion();
     }
    
       
	    
  }
  
  
},

error: function (response)
{
   NotifiAlert('Verifique su conexión a internet','w3-red',6000);
   $('#loadergif').hide();
}

});
}
}
</script>        
<script>
function RecConfirm(operadora,numero,cantidad)
{
  if(operadora=='' || numero=='' || cantidad=='')
  {
      NotifiAlert('Por favor complete todos los campos','w3-red',6000);
  }   
  else
  {
     $('#operconfirm').html($('#operadora').val());
     $('#numconfirm').html($('#NumeroCel').val());
     $('#montconfirm').html($('#cantidad').val());
     $('#recconfirm').show();
  }  
}
</script>